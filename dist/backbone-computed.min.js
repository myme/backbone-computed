this.Backbone.Model=function(t,e){"use strict";return t.extend({_computedProps:{},constructor:function(){var e=this._computedProps;this._computedProps={};var r,o;this._cachedProps={};for(r in e)e.hasOwnProperty(r)&&(o=e[r],this.addProperty(r,o.depends,o.action));return t.apply(this,arguments)},addProperty:function(t,e,r){void 0===r&&(r=e,e=[]);var o=this._computedProps;return o[t]={action:r,depends:e},this.setupDepsListeners(t,e),this},get:e.wrap(t.prototype.get,function(t,e){var r,o=this._computedProps;return o[e]?(r=o[e].action.call(this),this._cachedProps[e]=r,r):t.call(this,e)}),set:e.wrap(t.prototype.set,function(t,e,r){var o,s=this._computedProps;return s[e]?(o=s[e].action.call(this,r),this._cachedProps[e]!==o&&(this._cachedProps[e]=o,this.trigger("change:"+e,this,e)),this):t.call(this,e,r)}),setupDepsListeners:function(t,e){e=e||[];for(var r=this,o=function(){r.trigger("change:"+t,r,t)},s=e.length;s--;)this.on("change:"+e[s],o)}},{addProperty:function(t,e,r){return void 0===r&&(r=e,e=[]),this.prototype._computedProps[t]={action:r,depends:e},this},extend:e.wrap(t.extend,function(t,r,o){r=r||{};var s=this.normalizeComputedProps(r.properties);delete r.properties;var n=t.call(this,r,o);return e.extend(n.prototype,{_computedProps:s}),n}),normalizeComputedProps:function(t){var e,r,o,s,n={};if(!t)return{};for(o in t)t.hasOwnProperty(o)&&(e=t[o],e instanceof Function?(r=e,s=[]):(r=e.action,s=e.depends||[]),n[o]={action:r,depends:s});return n}})}(this.Backbone.Model,this._);