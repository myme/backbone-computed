(function(t){"use strict";function r(t,r){return function(){t.trigger("change:"+r,t,r)}}function e(t,e,n){n=n||[];for(var o=n.length;o--;)t.on("change:"+n[o],r(t,e))}function n(t){var r,e,n,o,i={};if(!t)return{};for(n in t)t.hasOwnProperty(n)&&(r=t[n],r instanceof Function?(e=r,o=[]):(e=r.action,o=r.depends||[]),i[n]={action:e,deps:o});return i}var o=t.Model.extend,i=function(t){return function(r){var e,n=this._computedProps;return n[r]?(e=n[r].action.call(this),this._cachedProps[r]=e,e):t.apply(this,arguments)}},s=function(t){return function(r,e){var n,o=this._computedProps;return o[r]?(n=o[r].action.call(this,e),this._cachedProps[r]!==n&&(this._cachedProps[r]=n,this.trigger("change:"+r,this,r)),this):t.apply(this,arguments)}};t.Model.extend=function(t,r){var c=this;t=t||{};var p=n(t.properties);delete t.properties,t.constructor=function(){var t,r=this._computedProps;this._cachedProps={};for(t in r)r.hasOwnProperty(t)&&e(this,t,r[t].deps);return c.apply(this,arguments)};var a=o.call(this,t,r);return a.prototype._computedProps=p,a.prototype.get=i(a.prototype.get),a.prototype.set=s(a.prototype.set),a}})(this.Backbone,this._);